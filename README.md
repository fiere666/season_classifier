Классификатор времен года по изображениям

Описание
Программа нужна для автоматического определения времени года,создана на основе анализа изображений пейзажей.

Архитектура создания решений:

1.Извлечение признаков:
Из каждого изображения извлекается 41 цветовой признак:
- цветовые характеристики: средние значения HSV (тон, насыщенность, яркость)
- статистики: стандартные отклонения цветов
- цвета сезонов: доли зеленых, холодных и теплых цветов
- гистограмма : распределение тонов (32 бина). гистограмма показывает: Сколько пикселей в изображении имеют тон в конкретном диапазоне.

2.Модель машинного обучения
- Алгоритм: Random Forest Classifier
- Параметры: 100 деревьев, максимальная глубина 10
- кол-во данных для обучения: 75% данных (12 изображений)
- кол-во данных для тестирования: 25% данных (4 изображения)

3.Классификация
- На вход: новое изображение → 41 признак
- На выходе: предсказанный сезон + вероятности для всех сезонов
- Уверенность в ответах: процентная вероятность от 0% до 100%

4.Результаты:
Точность модели:
- На тестовых данных: 50% (2 из 4 правильно)
- Кросс-валидация: 85.0% ± 10.0%
- Основные признаки: теплые цвета, зеленые цвета, холодные цвета(features_importance.png)

5.Матрица ошибок:(confusion_matrix.png)
- Ошибки:
Весна (реальная) → предсказана как лето (1 случай,неверно).
Зима (реальная) → предсказана как лето (1 случай,неерно).
Лето (реальная) → предсказана как лето (1 случай, верно).
Осень (реальная) → предсказана как осень (1 случай, верно).

6.Использование:
6.1 Установка зависимостей:
- pip install -r requirements.txt
6.2 Обучение модели:
- python train.py
6.3 Классификация изображений:
- python predict.py 
Или
- python predict.py "data/название папки/название изображения.jpg"

7.Используемые библиотеки:
- scikit-learn (1.3.0) - random forest, метрики оценки
- opencv-python (4.8.1) - обработка изображений, цветовые пространства
- numpy (1.24.3) - математические операции, массивы
- matplotlib (3.7.2) - визуализация результатов
- joblib (1.3.2) - сохранение и загрузка моделей
(еще встроенные в python - os,glob,sys)

8.Обоснование выбора алгоритма random forest:
- Работает на малых данных (16 изображений достаточно)
- Устойчив к переобучению (важно при 4 изображениях на класс)
- Дает вероятности (требование задания)
- Интерпретируем (показывает важные признаки)
- Быстрое обучение и предсказание

9.Структура проекта:
- model.py (Основной модуль в котором разработана модель для классификации времен года по изображениям)
- predict.py (скрипт для использования модели)
- train.py (скрипт обучения модели)
- requierments.txt (файл зависимостей)
- season_classifier.pkl (сохраненная модель)
- confusion_matrix.png (матрица ошибок)
- feature_importance.png (важность каждого из признаков)
- README.MD (документация проекта)
Данные для обработки:
-   ├ data/ (обучающие данные)
    │ ├ spring/4 изображения лета
    │ ├ summers/4 изображения осени
    │ ├ autumn/4 изображения осени
    │ ├ random/случайные изображения времен года
    │ └ winter/4 изображения зимы


10. ПОЛНЫЙ РАБОЧИЙ ЦИКЛ:
Этап 1.
1.Пользователь запускает train.py
2.model.py загружает все изображения из папки data/
    spring/ - 4 фото весны
    summers/ - 4 фото лета  
    autumn/ - 4 фото осени
    winter/ - 4 фото зимы
3.Для КАЖДОГО изображения извлекаются 41 признак:
    Преобразование в HSV цветовое пространство
    Расчет средних значений и стандартных отклонений
    Определение долей "сезонных" цветов
    Создание гистограммы тонов
4.Формируется таблица данных:
    Строки = изображения (16 шт.)
    Столбцы = признаки (41 шт.)
    Метки = названия сезонов
5.Данные делятся на обучающие (75%) и тестовые (25%)
6.Обучается модель random forest:
    Создается 100 деревьев
    Каждое дерево учится на разных частях данных
    Модель запоминает закономерности
7.Оценка качества:
    Тестирование на отложенных данных
    Создание матрицы ошибок
    Расчет точности 
8.Сохранение результатов:
    Модель - season_classifier.pkl
    Графики - confusion_matrix.png, feature_importance.png

Этап 2.Использование.
1.Пользователь запускает predict.py с путем к фото(либо взаимодействует )
2.Система загружает обученную модель из .pkl файла
3.Из нового изображения извлекаются  41 признак
4.Признаки подаются в модель random forest
5.Каждое из 100 деревьев "голосует" за свой вариант:
    Дерево 1: "весна" (уверенность 70%)
    Дерево 2: "лето" (уверенность 85%)
    Дерево 3: "весна" (уверенность 65%)
    и т.д
6.Система подсчитывает "голоса":
    Лето: 45 деревьев
    Весна: 35 деревьев  
    Осень: 15 деревьев
    Зима: 5 деревьев
7.Выдается результат:
    Предсказанный сезон: "Лето"
    Уверенность: 45% (45/100 деревьев)
    Вероятности всех классов: [весна=35%, лето=45%, осень=15%, зима=5%]

11. Принцип работы
- model.py
    1.extract_features()
    Загружает изображение - Конвертирует в HSV (cv2.imread(),cv2.cvtColor(img, cv2.COLOR_BGR2HSV)- OPENCV)
    Считает статистики - Вычисляет доли цветов (np.mean(), np.std(), cv2.inRange() для масок + np.sum()- OPENCV +NUMPY)
    Строит гистограмму - Возвращает 41 число (cv2.calcHist(), np.array(), np.concatenate()-  OPENCV +NUMPY)

    2.load_dataset()
    Проходит по папкам data/ - Для каждого фото вызывает extract_features() (os.path.join(), glob.glob()- OS, GLOB)
    Собирает ВСЕ признаки в одну таблицу (np.array()- NUMPY)
    Добавляет метки (весна, лето, ...)

    3.train_season_classifier()
    Берет таблицу из load_dataset() - Делит на обучающую/тестовую части (X,Y,train_test_split()- SCIKIT-LEARN)
    Создает RandomForest с 100 деревьями - Обучает на обучающих данных (RandomForestClassifier(), model.fit()- SCIKIT-LEARN)
    Проверяет на тестовых данных,оценивает надежность,анализ - Рисует графики, выводит отчет,сохраняет модель (model.score(), model.predict(), cross_val_score(), classification_report(), confusion_matrix(), plt.figure(), plt.imshow(), plt.bar(), joblib.dump() - SCIKIT-LEARN,КРОСС-ВАЛИДАЦИЯ,MATPLOTLIB)

- train.py
    Начало - Загружает model.py - Обучает модель - Сохраняет модель(в .pkl файл)

- predict.py
    Вариант А (с аргументом):
    python predict.py "фото.jpg" - Извлекает признаки - Прогоняет через модель - Выдает ответ

    Вариант Б (интерактивно):
    1.Показывает меню с доступными фото
    2.Пользователь выбирает номер
    3.Система находит путь к файлу
    4.Делает предсказание
    5.Показывает результат
